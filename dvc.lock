schema: '2.0'
stages:
  prepare:
    cmd: python src/data/prepare.py
    deps:
    - path: data/raw/imdb_test.csv
      hash: md5
      md5: 0b6a6e22790570c21fc32211b41578c3
      size: 32540147
    - path: data/raw/imdb_train.csv
      hash: md5
      md5: dc4c040dd7f3bfb42a279cb1f73725d5
      size: 33322167
    - path: src/data/prepare.py
      hash: md5
      md5: 6b0d01aea04ef8bd57b3a1c43eeaa66e
      size: 1886
    params:
      params.yaml:
        data:
          raw:
            train: data/raw/imdb_train.csv
            test: data/raw/imdb_test.csv
          processed:
            train: data/processed/train_clean.csv
            test: data/processed/test_clean.csv
          split_info: data/split_info.json
          schema:
            text_col: text
            label_col: label
            label_domain:
            - 0
            - 1
          split:
            strategy: fixed_from_split_info
            train_ratio: 0.5
        preprocessing:
          lowercase: true
          remove_html_tags: true
          normalize_whitespace: true
        random_seed: 42
    outs:
    - path: data/processed/test_clean.csv
      hash: md5
      md5: 59f1efb0e75ecc10e4bba7b87cf0aaa1
      size: 31981124
    - path: data/processed/train_clean.csv
      hash: md5
      md5: 8f3acb130ef3e13210745a0eec515504
      size: 32753300
  features:
    cmd: python src/features/build_features.py
    deps:
    - path: data/processed/test_clean.csv
      hash: md5
      md5: 59f1efb0e75ecc10e4bba7b87cf0aaa1
      size: 31981124
    - path: data/processed/train_clean.csv
      hash: md5
      md5: 8f3acb130ef3e13210745a0eec515504
      size: 32753300
    - path: src/features/build_features.py
      hash: md5
      md5: 0e3b27ec6ceeaca00444815269f72177
      size: 2246
    params:
      params.yaml:
        features:
          vectorizer: tfidf
          tfidf:
            max_features: 10000
            ngram_range:
            - 1
            - 2
            min_df: 2
            max_df: 0.95
          outputs:
            train_features: data/processed/train_features.npz
            test_features: data/processed/test_features.npz
            vectorizer_path: models/tfidf_vectorizer.pkl
    outs:
    - path: data/processed/test_features.npz
      hash: md5
      md5: b5f8c5afa28f96c74d9c3be9a9ea69cc
      size: 40234664
    - path: data/processed/train_features.npz
      hash: md5
      md5: 551daaab635d3bba6fb7b2c6d8eb0e45
      size: 42016709
    - path: models/tfidf_vectorizer.pkl
      hash: md5
      md5: 3dfff3bf2ffab7e888798b4fccfb1964
      size: 377486
  train:
    cmd: python src/modeling/train.py
    deps:
    - path: data/processed/train_features.npz
      hash: md5
      md5: 551daaab635d3bba6fb7b2c6d8eb0e45
      size: 42016709
    - path: src/modeling/train.py
      hash: md5
      md5: e6faff1d09723709eabbe3942a250cb8
      size: 1545
    params:
      params.yaml:
        train:
          model_type: logistic_regression
          logreg:
            max_iter: 1000
            random_state: 42
          outputs:
            model_path: models/model.pkl
    outs:
    - path: models/model.pkl
      hash: md5
      md5: cfdb2a147a1c77cb3f70623f3cbe2170
      size: 80891
  eval:
    cmd: python src/modeling/eval.py
    deps:
    - path: data/processed/test_features.npz
      hash: md5
      md5: b5f8c5afa28f96c74d9c3be9a9ea69cc
      size: 40234664
    - path: models/model.pkl
      hash: md5
      md5: cfdb2a147a1c77cb3f70623f3cbe2170
      size: 80891
    - path: src/modeling/eval.py
      hash: md5
      md5: 54474d93df0d965320498cffcd143f70
      size: 3135
    params:
      params.yaml:
        eval:
          metrics:
          - accuracy
          - precision
          - recall
          - f1
          outputs:
            metrics_json: reports/metrics.json
            confusion_matrix_png: reports/figures/baseline_confusion_matrix.png
    outs:
    - path: reports/metrics.json
      hash: md5
      md5: b0301dcb55b286cfad2e433e656bee7d
      size: 395
